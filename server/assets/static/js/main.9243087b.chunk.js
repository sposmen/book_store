(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{104:function(e,t,a){e.exports=a.p+"static/media/downloadLogo.eb839bb2.svg"},105:function(e,t,a){"use strict";var n=a(6),r=a(7),o=a(12),l=a(11),i=a(10),s=a(13),c=a(0),u=a.n(c),m=a(42),h=a(18),d=a(52),p=a(50),E=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).changeHandler=function(e){var t=a.state.newBook;t[e.target.name]=e.target.value,a.setState({newUser:t})},a.hideNew=e.hideNew,a.state={newBook:{}},a.handleSubmit=a.handleSubmit.bind(Object(i.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=new FormData,n=document.getElementById("formBasicFile");a.append("bookFile",n.files[0]),Object.keys(this.state.newBook).forEach((function(e){a.append(e,t.state.newBook[e])})),p.a.post({url:"/api/books",data:a,headers:{"content-type":"multipart/form-data"}}).then((function(e){console.log(e),t.hideNew()}))}},{key:"newBookForm",value:function(){return u.a.createElement(m.a.Body,null,u.a.createElement(h.a.Group,{controlId:"formBasicName"},u.a.createElement(h.a.Label,null,"Book Name"),u.a.createElement(h.a.Control,{type:"text",name:"name",placeholder:"Enter Book Name",onChange:this.changeHandler,required:!0})),u.a.createElement(h.a.Group,{controlId:"formBasicAuthor"},u.a.createElement(h.a.Label,null,"Author Name"),u.a.createElement(h.a.Control,{type:"text",name:"author",placeholder:"Enter Author Name",onChange:this.changeHandler,required:!0})),u.a.createElement(h.a.Group,{controlId:"formBasicPrice"},u.a.createElement(h.a.Label,null,"Price"),u.a.createElement(h.a.Control,{type:"number",step:"0.01",name:"price",placeholder:"Enter Book Price",onChange:this.changeHandler,required:!0})),u.a.createElement(h.a.Group,{controlId:"formBasicFile"},u.a.createElement(h.a.Label,null,"Book File"),u.a.createElement(h.a.Control,{type:"file",name:"bookFile",required:!0,accept:"text/plain"})))}},{key:"render",value:function(){return u.a.createElement(m.a,{show:this.props.showNew,onHide:this.hideNew},u.a.createElement(h.a,{onSubmit:this.handleSubmit},u.a.createElement(m.a.Header,{closeButton:!0},u.a.createElement(m.a.Title,null,"New book")),this.newBookForm(),u.a.createElement(m.a.Footer,null,u.a.createElement(d.a,{variant:"secondary",onClick:this.hideNew},"Close"),u.a.createElement(d.a,{type:"submit",variant:"primary",onClick:this.handleSubmit},"Save Book"))))}}]),t}(u.a.Component);t.a=E},112:function(e,t,a){e.exports=a(189)},145:function(e,t){},148:function(e,t,a){},189:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),l=a.n(o),i=a(101),s=a.n(i),c=a(102),u=a.n(c),m=(a(148),a(6)),h=a(7),d=a(12),p=a(11),E=a(10),f=a(13),b=a(194),w=a(195),g=a(193),v=a(110),k=a(40),y=a(31),j=a(41),S=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={date:new Date},a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval((function(){return e.tick()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"tick",value:function(){this.setState({date:new Date})}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.date.toLocaleTimeString())}}]),t}(r.a.Component),O=a(19),C=null,B=[];function N(e,t){200===t.statusCode&&e.user&&(C=e.user),B.forEach((function(e){return e(C)}))}var I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(C&&(B.indexOf(e)<0&&B.push(e),e))return e(C);B.length||!C&&O.a.jwt&&O.a.get({url:"/api/jwt/me"},(function(e,t){N(e,t)})),e&&B.push(e)};setInterval(I,1e4);var U=function(e){C=null,O.a.flush(),B.forEach((function(e){return e(C)}))},L=a(18),P=a(52),q=a(192),H=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).children=e.children,a.variant=e.variant||"danger",a.state={show:!e.parentValue||e.parentValue()},a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"setShow",value:function(e){return this.props.parentValue&&this.props.parentValue(e),this.setState({show:this.props.parentValue?this.props.parentValue():e})}},{key:"render",value:function(){var e=this;return this.state.show?r.a.createElement(q.a,{variant:this.variant,onClose:function(){return e.setShow(!1)},dismissible:!0},this.children):""}}]),t}(r.a.Component),x=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).changeHandler=function(e){var t=a.state.newUser;t[e.target.name]=e.target.value,a.setState({newUser:t})},a.children=e.children,a.state={newUser:{email:"",password:""},error:!1},a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a.showError=a.showError.bind(Object(E.a)(a)),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleSubmit",value:function(e){var t,a,n=this;e.preventDefault(),e.stopPropagation(),t=this.state.newUser,a=function(e,t){if(400===t.statusCode)return n.showError(e.message)},O.a.post({url:"/api/jwt/auth",data:t},(function(e,t){N(e,t),a(e,t)}))}},{key:"showError",value:function(e){return void 0===e?this.state.error:this.setState({error:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"UserSignUp"},r.a.createElement(v.a,null,r.a.createElement(k.a,{md:{span:8}},r.a.createElement("div",{className:"UserSignIn"},this.state.error?r.a.createElement(H,{parentValue:this.showError},this.state.error):"",r.a.createElement(L.a,{onSubmit:this.handleSubmit},r.a.createElement(L.a.Group,{controlId:"formBasicEmail"},r.a.createElement(L.a.Label,null,"Email address"),r.a.createElement(L.a.Control,{name:"email",type:"email",placeholder:"Enter Email",onChange:this.changeHandler,required:!0})),r.a.createElement(L.a.Group,{controlId:"formBasicPassword"},r.a.createElement(L.a.Label,null,"Password"),r.a.createElement(L.a.Control,{name:"password",type:"password",placeholder:"Password",onChange:this.changeHandler,required:!0,minLength:"6"})),r.a.createElement(P.a,{variant:"primary",type:"submit"},"Sign In"))))))}}]),t}(r.a.Component),F=a(64),G=a.n(F),T=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).changeHandler=function(e){var t=a.state.newUser;t[e.target.name]=e.target.value,a.setState({newUser:t})},a.state={newUser:{name:"",email:"",password:""},error:!1,success:!1},a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a.showError=a.showError.bind(Object(E.a)(a)),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleSubmit",value:function(e){var t,a,n=this;e.preventDefault(),e.stopPropagation(),t=this.state.newUser,a=function(e,t){if(400===t.statusCode)return n.showError(e.message)},O.a.post({url:"/api/jwt/signup",data:t},(function(e,t){N(e,t),a(e,t)}))}},{key:"showError",value:function(e){return void 0===e?this.state.error:this.setState({error:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"UserSignUp"},r.a.createElement(v.a,null,r.a.createElement(k.a,{md:{span:8}},this.state.error?r.a.createElement(H,{parentValue:this.showError},this.state.error):"",r.a.createElement(L.a,{onSubmit:this.handleSubmit},r.a.createElement(L.a.Group,{controlId:"formBasicFirstName"},r.a.createElement(L.a.Label,null,"First Name"),r.a.createElement(L.a.Control,{type:"text",name:"name",placeholder:"Enter First Name",onChange:this.changeHandler,required:!0})),r.a.createElement(L.a.Group,{controlId:"formBasicEmail"},r.a.createElement(L.a.Label,null,"Email address"),r.a.createElement(L.a.Control,{name:"email",type:"email",placeholder:"Enter Email",onChange:this.changeHandler,required:!0})),r.a.createElement(L.a.Group,{controlId:"formBasicPassword"},r.a.createElement(L.a.Label,null,"Password"),r.a.createElement(L.a.Control,{name:"password",type:"password",placeholder:"Password",onChange:this.changeHandler,required:!0,minLength:"6"})),r.a.createElement(P.a,{variant:"primary",type:"submit"},"Sign up"))),r.a.createElement(k.a,null,r.a.createElement("img",{src:G.a,className:"SignUp-logo",alt:"logo"}))))}}]),t}(r.a.Component),D=a(66),M={routes:[["/sign_in","Sign In"],["/sign_up","Sign Up"]],switch:[["/sign_up",r.a.createElement(T,null)],["/sign_in",r.a.createElement(x,null)]]},z={user:{routes:[["/books","Books"]],switch:[["/books",r.a.createElement(D.a,null)]]},admin:{routes:[["/books","Books"],["/users","Users"],["/orders","Orders"]],switch:[["/books",r.a.createElement(D.a,null)]]}},A=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"roleMenu",value:function(e){return e?z[e]:M}}]),e}();function V(){return r.a.createElement("h2",null,"Welcome to the Book Store")}function R(){return r.a.createElement("h2",null,"About")}var _=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={user:null},a.setUser=a.setUser.bind(Object(E.a)(a)),I(a.setUser),a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"setUser",value:function(e){this.setState({user:e})}},{key:"userRole",value:function(){return this.state.user&&this.state.user.accountType}},{key:"userMenu",value:function(){return A.roleMenu(this.userRole())}},{key:"pages",value:function(){return this.userMenu().switch.map((function(e,t){return r.a.createElement(y.a,{path:e[0],key:e[0]},e[1])}))}},{key:"routeLinks",value:function(){return this.userMenu().routes.map((function(e){return r.a.createElement(b.a.Link,{key:e[0],as:j.b,to:e[0]},e[1])}))}},{key:"navBar",value:function(){return r.a.createElement(w.a,{collapseOnSelect:!0,expand:"lg",bg:"primary",variant:"dark"},r.a.createElement(g.a,null,r.a.createElement(w.a.Brand,{as:j.b,to:"/"},"Book Store"),r.a.createElement(w.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(w.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(b.a,{className:"mr-auto"},this.routeLinks()),r.a.createElement(b.a,null,r.a.createElement(b.a.Link,{as:j.b,to:"/about"},"About"),this.userRole()?r.a.createElement(b.a.Link,{onClick:U},"Logout"):"",r.a.createElement(w.a.Text,null,r.a.createElement(S,null))))))}},{key:"pageSwitch",value:function(){return r.a.createElement(y.c,null,this.pages(),r.a.createElement(y.a,{path:"/about"},r.a.createElement(R,null)),r.a.createElement(y.a,{path:"/"},r.a.createElement(V,null)))}},{key:"render",value:function(){return r.a.createElement(j.a,null,this.navBar(),r.a.createElement(g.a,{className:"main"},r.a.createElement(v.a,null,r.a.createElement(k.a,null,this.pageSwitch()))))}}]),t}(r.a.Component),J=u()(s.a);J.sails.reconnection=!0,J.sails.url="localhost"===window.location.hostname?"http://".concat(window.location.hostname,":1337"):window.location.origin,window.io=J,l.a.render(r.a.createElement(_,null),document.getElementById("root"))},19:function(e,t,a){"use strict";var n=a(6),r=a(7),o=a(26),l=a.n(o),i=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"get",value:function(t,a){e.request(l.a.merge({},t,{method:"GET"}),a)}},{key:"post",value:function(t,a){e.request(l.a.merge({},t,{method:"POST"}),a)}},{key:"request",value:function(t,a){io.socket.request(l.a.merge({},t,{headers:{authorization:"Bearer ".concat(e.jwt)}}),(function(t,n){200===n.statusCode&&t.token&&localStorage.setItem("jwt",e.jwt=t.token),a(t,n)}))}},{key:"flush",value:function(){e.jwt=void 0,localStorage.removeItem("jwt")}}]),e}();i.jwt=localStorage.getItem("jwt"),t.a=i},50:function(e,t,a){"use strict";var n=a(6),r=a(7),o=a(26),l=a.n(o),i=a(106),s=a.n(i),c=a(19),u=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"get",value:function(t,a){return e.request(l.a.merge({},t,{method:"GET"}),a)}},{key:"post",value:function(t,a){return e.request(l.a.merge({},t,{method:"POST"}),a)}},{key:"download",value:function(t){var a;return t.filename&&(a=t.filename,delete t.filename),e.request(l.a.merge({},t,{method:"GET",responseType:"blob"})).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=t,n.setAttribute("download","".concat(a||"book",".txt")),document.body.appendChild(n),n.click(),setTimeout((function(){return document.body.removeChild(n)}),1e3)}))}},{key:"request",value:function(e,t){return(e=l.a.merge(e,{headers:{authorization:"Bearer ".concat(c.a.jwt)}})).url="".concat(io.sails.url).concat(e.url),s.a.request(e,(function(e,a){200===a.statusCode&&e.token&&localStorage.setItem("jwt",c.a.jwt=e.token),t(e,a)}))}}]),e}();t.a=u},64:function(e,t,a){e.exports=a.p+"static/media/signUpLogo.94717a01.svg"},66:function(e,t,a){"use strict";(function(e){var n=a(6),r=a(7),o=a(12),l=a(11),i=a(10),s=a(13),c=a(0),u=a.n(c),m=a(19),h=a(111),d=a(110),p=a(40),E=a(52),f=a(190),b=a(104),w=a.n(b),g=a(105),v=a(50),k=a(14),y=(a(64),function(t){function a(e){var t;Object(n.a)(this,a),(t=Object(o.a)(this,Object(l.a)(a).call(this,e))).pageSize=parseInt(t.params("pageSize"))||5,t.history=Object(k.a)();var r=parseInt(t.params("page"))||1;return t.state={showNew:!1,page:r,pageCount:1,books:[]},t.showNew=t.showNew.bind(Object(i.a)(t)),t.hideNew=t.hideNew.bind(Object(i.a)(t)),t}return Object(s.a)(a,t),Object(r.a)(a,[{key:"componentDidMount",value:function(){this.toPage(this.state.page)}},{key:"params",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new URLSearchParams(window.location.search);return e?t.get(e):t}},{key:"getBooks",value:function(){var e=this;if(this.state.page){var t=(this.state.page-1)*this.pageSize,a="/api/books?skip=".concat(t,"&limit=").concat(this.pageSize);m.a.get({url:a},(function(t,a){200===a.statusCode&&t&&e.setState({books:t})})),m.a.get({url:"/api/books/count"},(function(t,a){if(200===a.statusCode&&t){var n=Math.ceil(parseInt(t)/e.pageSize);e.state.page>n?e.toPage(n):e.setState({pageCount:n})}}))}}},{key:"showNew",value:function(){this.setState({showNew:!0})}},{key:"hideNew",value:function(){this.getBooks(),this.setState({showNew:!1})}},{key:"download",value:function(e){return function(){v.a.download({url:"/api/books/".concat(e.id,"/download"),filename:e.name})}}},{key:"toPage",value:function(t){var a=this;this.setState({page:t}),e((function(){return a.getBooks()})),this.history.push({pathname:"/books",search:"?"+new URLSearchParams({page:t}).toString()})}},{key:"pagination",value:function(){for(var e=this,t=Math.max(this.state.page-2,1),a=Math.min(t+5,this.state.pageCount),n=[],r=function(t){n.push(u.a.createElement(h.a.Item,{onClick:function(){return e.toPage(t)},key:t,active:t===e.state.page},t))},o=t;o<=a;o++)r(o);return u.a.createElement(h.a,null,n)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement(g.a,{showNew:this.state.showNew,hideNew:this.hideNew}),u.a.createElement(d.a,null,u.a.createElement(p.a,{md:"2"},u.a.createElement("h3",null,"Books")),u.a.createElement(p.a,null,u.a.createElement(E.a,{variant:"primary",onClick:this.showNew}," New "))),u.a.createElement(f.a,{striped:!0,size:"sm"},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Name"),u.a.createElement("th",null,"Author"),u.a.createElement("th",null,"Price"),u.a.createElement("th",null,"Keywords"),u.a.createElement("th",null,"Actions"))),u.a.createElement("tbody",null,this.state.books.map((function(t){return u.a.createElement("tr",{key:t.id},u.a.createElement("td",null,t.name),u.a.createElement("td",null,t.author),u.a.createElement("td",null,t.price),u.a.createElement("td",null,t.keywords&&t.keywords.join(", ")),u.a.createElement("td",null,u.a.createElement(E.a,{variant:"link",onClick:e.download(t)},u.a.createElement("img",{src:w.a,style:{width:20,height:20},className:"Download-logo",alt:"logo"}))))})))),u.a.createElement(d.a,null,u.a.createElement(p.a,null,this.pagination())))}}]),a}(u.a.Component));t.a=y}).call(this,a(157).setImmediate)}},[[112,1,2]]]);
//# sourceMappingURL=main.9243087b.chunk.js.map