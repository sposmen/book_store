(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{10:function(e,t,a){"use strict";var n=a(5),r=a(6),o=a(15),l=a.n(o),i=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"get",value:function(t,a){e.request(l.a.merge({},t,{method:"GET"}),a)}},{key:"post",value:function(t,a){e.request(l.a.merge({},t,{method:"POST"}),a)}},{key:"patch",value:function(t,a){e.request(l.a.merge({},t,{method:"PATCH"}),a)}},{key:"request",value:function(t,a){io.socket.request(l.a.merge({},t,{headers:{authorization:"Bearer ".concat(e.jwt)}}),(function(t,n){200===n.statusCode&&t.token&&localStorage.setItem("jwt",e.jwt=t.token),a(t,n)}))}},{key:"flush",value:function(){e.jwt=void 0,localStorage.removeItem("jwt")}}]),e}();i.jwt=localStorage.getItem("jwt"),t.a=i},111:function(e,t,a){e.exports=a.p+"static/media/signUpLogo.94717a01.svg"},112:function(e,t,a){e.exports=a.p+"static/media/downloadLogo.eb839bb2.svg"},113:function(e,t,a){"use strict";var n=a(5),r=a(6),o=a(8),l=a(7),i=a(9),s=a(0),c=a.n(s),u=a(26),h=a(198),m=a(20),d=a(37),p=a(56),f=a(15),E=a.n(f),v=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).changeHandler=function(e){var t=a.state.newBook;t[e.target.name]=e.target.value,a.setState({newUser:t})},a.handleSubmit=function(e){e.preventDefault(),e.stopPropagation();var t=new FormData,n=document.getElementById("formBasicFile");t.append("bookFile",n.files[0]),Object.keys(a.state.newBook).forEach((function(e){t.append(e,a.state.newBook[e])})),p.a.post({url:"/api/books",data:t,headers:{"content-type":"multipart/form-data"}}).then((function(e){console.log(e),a.hideNew()})).catch((function(e,t){E.a.isObject(e)&&a.setState({error:e.response.data}),E.a.isString(e)&&a.setState({error:e})}))},a.hideNew=e.hideNew,a.state={newBook:{},error:null},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"newBookForm",value:function(){return c.a.createElement(u.a.Body,null,this.state.error?c.a.createElement(h.a,{variant:"danger"},this.state.error):"",c.a.createElement(m.a.Group,{controlId:"formBasicName"},c.a.createElement(m.a.Label,null,"Book Name"),c.a.createElement(m.a.Control,{type:"text",name:"name",placeholder:"Enter Book Name",onChange:this.changeHandler,required:!0})),c.a.createElement(m.a.Group,{controlId:"formBasicAuthor"},c.a.createElement(m.a.Label,null,"Author Name"),c.a.createElement(m.a.Control,{type:"text",name:"author",placeholder:"Enter Author Name",onChange:this.changeHandler,required:!0})),c.a.createElement(m.a.Group,{controlId:"formBasicPrice"},c.a.createElement(m.a.Label,null,"Price"),c.a.createElement(m.a.Control,{type:"number",step:"0.01",name:"price",placeholder:"Enter Book Price",onChange:this.changeHandler,required:!0})),c.a.createElement(m.a.Group,{controlId:"formBasicFile"},c.a.createElement(m.a.Label,null,"Book File"),c.a.createElement(m.a.Control,{type:"file",name:"bookFile",required:!0,accept:"text/plain"})))}},{key:"render",value:function(){return c.a.createElement(u.a,{show:this.props.showNew,onHide:this.hideNew},c.a.createElement(m.a,{onSubmit:this.handleSubmit},c.a.createElement(u.a.Header,{closeButton:!0},c.a.createElement(u.a.Title,null,"New book")),this.newBookForm(),c.a.createElement(u.a.Footer,null,c.a.createElement(d.a,{variant:"secondary",onClick:this.hideNew},"Close"),c.a.createElement(d.a,{type:"submit",variant:"primary",onClick:this.handleSubmit},"Save Book"))))}}]),t}(c.a.Component);t.a=v},118:function(e,t,a){"use strict";(function(e){var n=a(55),r=a(5),o=a(6),l=a(8),i=a(7),s=a(9),c=a(0),u=a.n(c),h=a(10),m=a(45),d=a(44),p=a(31),f=a(75),E=a(120),v=a(37),g=a(12),b=a(17),k=a(119);function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var y=function(t){function a(e){var t;Object(r.a)(this,a),(t=Object(l.a)(this,Object(i.a)(a).call(this,e))).userRole=function(e){t.setState({userRole:e?e.accountType:null})},t.toggleActive=function(e){return function(){h.a.patch({url:"/api/users/".concat(e.id),data:{active:!e.active}},(function(e,a){if(200===a.statusCode&&e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t.state.users);r[e.id]=e,t.setState({users:r})}}))}},t.showOrders=function(e){return function(){t.setState({showOrders:e})}},t.hideOrders=function(){t.setState({showOrders:!1})},t.pageSize=parseInt(t.params("pageSize"))||5,t.history=Object(g.a)();var o=parseInt(t.params("page"))||1;return t.state={showOrders:!1,page:o,pageCount:1,users:{},userRole:null},t}return Object(s.a)(a,t),Object(o.a)(a,[{key:"componentDidMount",value:function(){Object(b.b)(this.userRole),this.toPage(this.state.page)}},{key:"params",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new URLSearchParams(window.location.search);return e?t.get(e):t}},{key:"getUsers",value:function(){var e=this;if(this.state.page){var t=(this.state.page-1)*this.pageSize,a="/api/users?skip=".concat(t,"&limit=").concat(this.pageSize);h.a.get({url:a},(function(t,a){if(200===a.statusCode&&t){var n={};t.forEach((function(e){return n[e.id]=e})),e.setState({users:n})}})),h.a.get({url:"/api/users/count"},(function(t,a){if(200===a.statusCode&&t){var n=Math.ceil(parseInt(t)/e.pageSize);e.state.page>n?e.toPage(n):e.setState({pageCount:n})}}))}}},{key:"toPage",value:function(t){var a=this;this.setState({page:t}),e((function(){return a.getUsers()})),this.history.push({pathname:"/users",search:"?"+new URLSearchParams({page:t}).toString()})}},{key:"pagination",value:function(){for(var e=this,t=Math.max(this.state.page-2,1),a=Math.min(t+5,this.state.pageCount),n=[],r=function(t){n.push(u.a.createElement(m.a.Item,{onClick:function(){return e.toPage(t)},key:t,active:t===e.state.page},t))},o=t;o<=a;o++)r(o);return u.a.createElement(m.a,null,n)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,this.state.showOrders?u.a.createElement(k.a,{showOrders:this.state.showOrders,hideOrders:this.hideOrders}):"",u.a.createElement(d.a,null,u.a.createElement(p.a,{md:"2"},u.a.createElement("h3",null,"Users"))),u.a.createElement(f.a,{striped:!0,size:"sm"},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Name"),u.a.createElement("th",null,"Email"),u.a.createElement("th",null,"Orders"),u.a.createElement("th",null,"Actions"))),u.a.createElement("tbody",null,Object.keys(this.state.users).map((function(t,a){var n=e.state.users[t];return u.a.createElement("tr",{key:t},u.a.createElement("td",null,n.name),u.a.createElement("td",null,n.email),u.a.createElement("td",null,n.orders.length),u.a.createElement("td",null,u.a.createElement(E.a,null,u.a.createElement(v.a,{variant:n.active?"success":"secondary",onClick:e.toggleActive(n),size:"sm"},n.active?"Active":"Inactive"),"\xa0",u.a.createElement(v.a,{variant:"primary",onClick:e.showOrders(n),size:"sm"},"Orders"))))})))),u.a.createElement(d.a,null,u.a.createElement(p.a,null,this.pagination())))}}]),a}(u.a.Component);t.a=y}).call(this,a(67).setImmediate)},119:function(e,t,a){"use strict";var n=a(5),r=a(6),o=a(8),l=a(7),i=a(9),s=a(0),c=a.n(s),u=a(26),h=a(37),m=a(57),d=a(10),p=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).hideOrders=e.hideOrders,a.state={orders:{},error:null},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this,t='/api/orders/?where={"owner":"'.concat(this.props.showOrders.id,'"}&sort=createdAt%20DESC&populate=books,owner');d.a.get({url:t},(function(t,a){if(200===a.statusCode&&t){var n={};t.forEach((function(e){return n[e.id]=e})),e.setState({orders:n})}}))}},{key:"ordersTable",value:function(){return c.a.createElement(u.a.Body,null,c.a.createElement(m.a,{orders:this.state.orders}))}},{key:"render",value:function(){return c.a.createElement(u.a,{size:"lg",show:!!this.props.showOrders,onHide:this.hideOrders},c.a.createElement(u.a.Header,{closeButton:!0},c.a.createElement(u.a.Title,null,this.props.showOrders.name," - Orders")),this.ordersTable(),c.a.createElement(u.a.Footer,null,c.a.createElement(h.a,{variant:"secondary",onClick:this.hideOrders},"Close")))}}]),t}(c.a.Component);t.a=p},121:function(e,t,a){e.exports=a(197)},154:function(e,t){},157:function(e,t,a){},17:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return h}));var n=a(10),r=null,o=[];function l(e,t){200===t.statusCode&&e.user&&(r=e.user),o.forEach((function(e){return e(r)}))}var i=!1,s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e&&o.indexOf(e)<0&&o.push(e),r&&e)return e(r);i||r||!n.a.jwt||(i=!0,n.a.get({url:"/api/jwt/me"},(function(e,t){i=!1,l(e,t)})))},c=function(e){r=null,n.a.flush(),o.forEach((function(e){return e(r)}))},u=function(e,t){n.a.post({url:"/api/jwt/signup",data:e},(function(e,a){l(e,a),t(e,a)}))},h=function(e,t){n.a.post({url:"/api/jwt/auth",data:e},(function(e,a){l(e,a),t(e,a)}))}},197:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(27),l=a.n(o),i=a(108),s=a.n(i),c=a(109),u=a.n(c),h=(a(157),a(5)),m=a(6),d=a(8),p=a(7),f=a(23),E=a(9),v=a(201),g=a(202),b=a(200),k=a(44),w=a(31),y=a(30),O=a(43),j=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={date:new Date},a}return Object(E.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval((function(){return e.tick()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"tick",value:function(){this.setState({date:new Date})}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.date.toLocaleTimeString())}}]),t}(r.a.Component),S=a(17),C=a(20),P=a(37),B=a(198),U=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).children=e.children,a.variant=e.variant||"danger",a.state={show:!e.parentValue||e.parentValue()},a}return Object(E.a)(t,e),Object(m.a)(t,[{key:"setShow",value:function(e){return this.props.parentValue&&this.props.parentValue(e),this.setState({show:this.props.parentValue?this.props.parentValue():e})}},{key:"render",value:function(){var e=this;return this.state.show?r.a.createElement(B.a,{variant:this.variant,onClose:function(){return e.setShow(!1)},dismissible:!0},this.children):""}}]),t}(r.a.Component),I=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).changeHandler=function(e){var t=a.state.newUser;t[e.target.name]=e.target.value,a.setState({newUser:t})},a.children=e.children,a.state={newUser:{email:"",password:""},error:!1},a.handleSubmit=a.handleSubmit.bind(Object(f.a)(a)),a.showError=a.showError.bind(Object(f.a)(a)),a}return Object(E.a)(t,e),Object(m.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),Object(S.c)(this.state.newUser,(function(e,a){if(400===a.statusCode)return t.showError(e)}))}},{key:"showError",value:function(e){return void 0===e?this.state.error:this.setState({error:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"UserSignUp"},r.a.createElement(k.a,null,r.a.createElement(w.a,{md:{span:8}},r.a.createElement("div",{className:"UserSignIn"},this.state.error?r.a.createElement(U,{parentValue:this.showError},this.state.error):"",r.a.createElement(C.a,{onSubmit:this.handleSubmit},r.a.createElement(C.a.Group,{controlId:"formBasicEmail"},r.a.createElement(C.a.Label,null,"Email address"),r.a.createElement(C.a.Control,{name:"email",type:"email",placeholder:"Enter Email",onChange:this.changeHandler,required:!0})),r.a.createElement(C.a.Group,{controlId:"formBasicPassword"},r.a.createElement(C.a.Label,null,"Password"),r.a.createElement(C.a.Control,{name:"password",type:"password",placeholder:"Password",onChange:this.changeHandler,required:!0,minLength:"6"})),r.a.createElement(P.a,{variant:"primary",type:"submit"},"Sign In"))))))}}]),t}(r.a.Component),N=a(111),z=a.n(N),L=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).changeHandler=function(e){var t=a.state.newUser;t[e.target.name]=e.target.value,a.setState({newUser:t})},a.state={newUser:{name:"",email:"",password:""},error:!1,success:!1},a.handleSubmit=a.handleSubmit.bind(Object(f.a)(a)),a.showError=a.showError.bind(Object(f.a)(a)),a}return Object(E.a)(t,e),Object(m.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),Object(S.d)(this.state.newUser,(function(e,a){if(400===a.statusCode)return t.showError(e.message)}))}},{key:"showError",value:function(e){return void 0===e?this.state.error:this.setState({error:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"UserSignUp"},r.a.createElement(k.a,null,r.a.createElement(w.a,{md:{span:8}},this.state.error?r.a.createElement(U,{parentValue:this.showError},this.state.error):"",r.a.createElement(C.a,{onSubmit:this.handleSubmit},r.a.createElement(C.a.Group,{controlId:"formBasicFirstName"},r.a.createElement(C.a.Label,null,"First Name"),r.a.createElement(C.a.Control,{type:"text",name:"name",placeholder:"Enter First Name",onChange:this.changeHandler,required:!0})),r.a.createElement(C.a.Group,{controlId:"formBasicEmail"},r.a.createElement(C.a.Label,null,"Email address"),r.a.createElement(C.a.Control,{name:"email",type:"email",placeholder:"Enter Email",onChange:this.changeHandler,required:!0})),r.a.createElement(C.a.Group,{controlId:"formBasicPassword"},r.a.createElement(C.a.Label,null,"Password"),r.a.createElement(C.a.Control,{name:"password",type:"password",placeholder:"Password",onChange:this.changeHandler,required:!0,minLength:"6"})),r.a.createElement(P.a,{variant:"primary",type:"submit"},"Sign up"))),r.a.createElement(w.a,null,r.a.createElement("img",{src:z.a,className:"SignUp-logo",alt:"logo"}))))}}]),t}(r.a.Component),D=a(54),T=a(118),R=a(120),M=a(10),q=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(m.a)(t,[{key:"booksUrl",value:function(){var e=(this.state.page-1)*this.pageSize;return"/api/books?skip=".concat(e,"&limit=").concat(this.pageSize,'&where={"active":true}')}},{key:"booksCountUrl",value:function(){return"/api/books/count?active=true"}},{key:"addToCart",value:function(e){var t=this;return function(){M.a.post({url:"/api/carts",data:{bookId:e.id}},(function(e,a){200===a.statusCode&&e&&t.setState({redirectTo:"/cart"})}))}}},{key:"actionButtons",value:function(e){return r.a.createElement(R.a,null,r.a.createElement(P.a,{variant:"primary",onClick:this.addToCart(e),size:"sm"},"Add to Cart"))}},{key:"showNewButton",value:function(){return""}}]),t}(D.a),A=a(58),H=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(m.a)(t,[{key:"ordersUrl",value:function(){var e=(this.state.page-1)*this.pageSize;return"/api/orders?skip=".concat(e,"&limit=").concat(this.pageSize)}},{key:"ordersCountUrl",value:function(){return"/api/orders/count?"}},{key:"showNewButton",value:function(){return""}}]),t}(A.a),x=a(75),F=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={books:[],total:0},a}return Object(E.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.getCart()}},{key:"getCart",value:function(){var e=this;M.a.get({url:"/api/carts"},(function(t,a){if(200===a.statusCode&&t){var n=t.reduce((function(e,t){return e+t.price}),0);e.setState({books:t,total:n})}}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k.a,null,r.a.createElement(w.a,{md:"2"},r.a.createElement("h3",null,"Cart"))),r.a.createElement(x.a,{striped:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Book"),r.a.createElement("th",null,"Price"))),r.a.createElement("tbody",null,this.state.books.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.price))}))),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Total"),r.a.createElement("th",null,this.state.total)))))}}]),t}(r.a.Component),G={routes:[["/sign_in","Sign In"],["/sign_up","Sign Up"]],switch:[["/sign_up",r.a.createElement(L,null)],["/sign_in",r.a.createElement(I,null)]]},V={user:{routes:[["/books","Books"],["/orders","My orders"],["/cart","My cart"]],switch:[["/books",r.a.createElement(q,null)],["/orders",r.a.createElement(H,null)],["/cart",r.a.createElement(F,null)]]},admin:{routes:[["/books","Books"],["/users","Users"],["/orders","Orders"]],switch:[["/books",r.a.createElement(D.a,null)],["/users",r.a.createElement(T.a,null)],["/orders",r.a.createElement(A.a,null)]]}},_=function(){function e(){Object(h.a)(this,e)}return Object(m.a)(e,null,[{key:"roleMenu",value:function(e){return e?V[e]:G}}]),e}();function J(){return r.a.createElement("h2",null,"Welcome to the Book Store")}function W(){return r.a.createElement("h2",null,"About")}var K=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={user:null},a.setUser=a.setUser.bind(Object(f.a)(a)),Object(S.b)(a.setUser),a}return Object(E.a)(t,e),Object(m.a)(t,[{key:"setUser",value:function(e){this.setState({user:e})}},{key:"userRole",value:function(){return this.state.user&&this.state.user.accountType}},{key:"userMenu",value:function(){return _.roleMenu(this.userRole())}},{key:"pages",value:function(){return this.userMenu().switch.map((function(e,t){return r.a.createElement(y.b,{path:e[0],key:e[0]},e[1])}))}},{key:"routeLinks",value:function(){return this.userMenu().routes.map((function(e){return r.a.createElement(v.a.Link,{key:e[0],as:O.b,to:e[0]},e[1])}))}},{key:"navBar",value:function(){return r.a.createElement(g.a,{collapseOnSelect:!0,expand:"lg",bg:"primary",variant:"dark"},r.a.createElement(b.a,null,r.a.createElement(g.a.Brand,{as:O.b,to:"/"},"Book Store"),r.a.createElement(g.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(g.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(v.a,{className:"mr-auto"},this.routeLinks()),r.a.createElement(v.a,null,r.a.createElement(v.a.Link,{as:O.b,to:"/about"},"About"),this.userRole()?r.a.createElement(v.a.Link,{onClick:S.a},"Logout"):"",r.a.createElement(g.a.Text,null,r.a.createElement(j,null))))))}},{key:"pageSwitch",value:function(){return r.a.createElement(y.d,null,this.pages(),r.a.createElement(y.b,{path:"/about"},r.a.createElement(W,null)),r.a.createElement(y.b,{path:"/"},r.a.createElement(J,null)))}},{key:"render",value:function(){return r.a.createElement(O.a,null,this.navBar(),r.a.createElement(b.a,{className:"main"},r.a.createElement(k.a,null,r.a.createElement(w.a,null,this.pageSwitch()))))}}]),t}(r.a.Component),Q=u()(s.a);Q.sails.reconnection=!0,Q.sails.url="localhost"===window.location.hostname?"http://".concat(window.location.hostname,":5000"):window.location.origin,window.io=Q,l.a.render(r.a.createElement(K,null),document.getElementById("root"))},54:function(e,t,a){"use strict";(function(e){var n=a(55),r=a(5),o=a(6),l=a(8),i=a(7),s=a(9),c=a(0),u=a.n(c),h=a(10),m=a(45),d=a(120),p=a(37),f=a(31),E=a(44),v=a(75),g=a(112),b=a.n(g),k=a(113),w=a(56),y=a(12),O=a(17),j=a(30);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var C=function(t){function a(e){var t;Object(r.a)(this,a),(t=Object(l.a)(this,Object(i.a)(a).call(this,e))).userRole=function(e){t.setState({userRole:e?e.accountType:null})},t.toggleActive=function(e){return function(){h.a.patch({url:"/api/books/".concat(e.id),data:{active:!e.active}},(function(e,a){if(200===a.statusCode&&e){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t.state.books);r[e.id]=e,t.setState({books:r})}}))}},t.showNew=function(){t.setState({showNew:!0})},t.hideNew=function(){t.getBooks(),t.setState({showNew:!1})},t.pageSize=parseInt(t.params("pageSize"))||5,t.history=Object(y.a)();var o=parseInt(t.params("page"))||1;return t.state={showNew:!1,page:o,pageCount:1,books:{},userRole:null,redirectTo:null},t}return Object(s.a)(a,t),Object(o.a)(a,[{key:"componentDidMount",value:function(){Object(O.b)(this.userRole),this.toPage(this.state.page)}},{key:"params",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new URLSearchParams(window.location.search);return e?t.get(e):t}},{key:"booksUrl",value:function(){var e=(this.state.page-1)*this.pageSize;return"/api/books?skip=".concat(e,"&limit=").concat(this.pageSize)}},{key:"booksCountUrl",value:function(){return"/api/books/count"}},{key:"getBooks",value:function(){var e=this;this.state.page&&(h.a.get({url:this.booksUrl()},(function(t,a){if(200===a.statusCode&&t){var n={};t.forEach((function(e){return n[e.id]=e})),e.setState({books:n})}})),h.a.get({url:this.booksCountUrl()},(function(t,a){if(200===a.statusCode&&t){var n=Math.ceil(parseInt(t)/e.pageSize);e.state.page>n?e.toPage(n):e.setState({pageCount:n})}})))}},{key:"download",value:function(e){return function(){w.a.download({url:"/api/books/".concat(e.id,"/download"),filename:e.name})}}},{key:"toPage",value:function(t){var a=this;this.setState({page:t}),e((function(){return a.getBooks()})),this.history.push({pathname:"/books",search:"?"+new URLSearchParams({page:t}).toString()})}},{key:"pagination",value:function(){for(var e=this,t=Math.max(this.state.page-2,1),a=Math.min(t+5,this.state.pageCount),n=[],r=function(t){n.push(u.a.createElement(m.a.Item,{onClick:function(){return e.toPage(t)},key:t,active:t===e.state.page},t))},o=t;o<=a;o++)r(o);return u.a.createElement(m.a,null,n)}},{key:"actionButtons",value:function(e){return u.a.createElement(d.a,null,u.a.createElement(p.a,{variant:"link",onClick:this.download(e)},u.a.createElement("img",{src:b.a,style:{width:20,height:20},className:"Download-logo",alt:"logo"})),u.a.createElement(p.a,{variant:e.active?"success":"secondary",onClick:this.toggleActive(e),size:"sm"},e.active?"Active":"Inactive"))}},{key:"showNewButton",value:function(){return u.a.createElement(f.a,null,u.a.createElement(p.a,{variant:"primary",onClick:this.showNew}," New "))}},{key:"render",value:function(){var e=this;return this.state.redirectTo?u.a.createElement(j.a,{to:this.state.redirectTo}):u.a.createElement("div",null,u.a.createElement(k.a,{showNew:this.state.showNew,hideNew:this.hideNew}),u.a.createElement(E.a,null,u.a.createElement(f.a,{md:"2"},u.a.createElement("h3",null,"Books")),this.showNewButton()),u.a.createElement(v.a,{striped:!0,size:"sm"},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Name"),u.a.createElement("th",null,"Author"),u.a.createElement("th",null,"Price"),u.a.createElement("th",null,"Keywords"),u.a.createElement("th",null,"Actions"))),u.a.createElement("tbody",null,Object.keys(this.state.books).map((function(t,a){var n=e.state.books[t];return u.a.createElement("tr",{key:t},u.a.createElement("td",null,n.name),u.a.createElement("td",null,n.author),u.a.createElement("td",null,n.price),u.a.createElement("td",null,n.keywords&&n.keywords.join(", ")),u.a.createElement("td",null,e.actionButtons(n)))})))),u.a.createElement(E.a,null,u.a.createElement(f.a,null,this.pagination())))}}]),a}(u.a.Component);t.a=C}).call(this,a(67).setImmediate)},56:function(e,t,a){"use strict";var n=a(5),r=a(6),o=a(15),l=a.n(o),i=a(114),s=a.n(i),c=a(10),u=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"get",value:function(t,a){return e.request(l.a.merge({},t,{method:"GET"}),a)}},{key:"post",value:function(t,a){return e.request(l.a.merge({},t,{method:"POST"}),a)}},{key:"patch",value:function(t,a){return e.request(l.a.merge({},t,{method:"PATCH"}),a)}},{key:"download",value:function(t){var a;return t.filename&&(a=t.filename,delete t.filename),e.request(l.a.merge({},t,{method:"GET",responseType:"blob"})).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=t,n.setAttribute("download","".concat(a||"book",".txt")),document.body.appendChild(n),n.click(),setTimeout((function(){return document.body.removeChild(n)}),1e3)}))}},{key:"request",value:function(e,t){return(e=l.a.merge(e,{headers:{authorization:"Bearer ".concat(c.a.jwt)}})).url="".concat(io.sails.url).concat(e.url),s.a.request(e,(function(e,a){200===a.statusCode&&e.token&&localStorage.setItem("jwt",c.a.jwt=e.token),t(e,a)}))}}]),e}();t.a=u},57:function(e,t,a){"use strict";var n=a(75),r=a(0),o=a.n(r);t.a=function(e){return e.orders?o.a.createElement(n.a,{striped:!0,size:"sm"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Order ID"),o.a.createElement("th",null,"Date"),o.a.createElement("th",null,"User Email"),o.a.createElement("th",null,"Books"))),o.a.createElement("tbody",null,Object.keys(e.orders).map((function(t){var a=e.orders[t];return o.a.createElement("tr",{key:t},o.a.createElement("td",null,t),o.a.createElement("td",null,new Date(a.createdAt).toLocaleDateString()),o.a.createElement("td",null,a.owner.email),o.a.createElement("td",null,a.books.map((function(e){return o.a.createElement("div",{key:e.id},"- ",e.name)}))))})))):""}},58:function(e,t,a){"use strict";(function(e){var n=a(5),r=a(6),o=a(8),l=a(7),i=a(9),s=a(0),c=a.n(s),u=a(10),h=a(45),m=a(44),d=a(31),p=a(12),f=a(17),E=a(57),v=function(t){function a(e){var t;Object(n.a)(this,a),(t=Object(o.a)(this,Object(l.a)(a).call(this,e))).userRole=function(e){t.setState({userRole:e?e.accountType:null})},t.pageSize=parseInt(t.params("pageSize"))||5,t.history=Object(p.a)();var r=parseInt(t.params("page"))||1;return t.state={page:r,pageCount:1,orders:{},userRole:null},t}return Object(i.a)(a,t),Object(r.a)(a,[{key:"componentDidMount",value:function(){Object(f.b)(this.userRole),this.toPage(this.state.page)}},{key:"params",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new URLSearchParams(window.location.search);return e?t.get(e):t}},{key:"ordersUrl",value:function(){var e=(this.state.page-1)*this.pageSize;return"/api/orders?skip=".concat(e,"&limit=").concat(this.pageSize)}},{key:"ordersCountUrl",value:function(){return"/api/orders/count"}},{key:"getOrders",value:function(){var e=this;this.state.page&&(u.a.get({url:this.ordersUrl()},(function(t,a){if(200===a.statusCode&&t){var n={};t.forEach((function(e){return n[e.id]=e})),e.setState({orders:n})}})),u.a.get({url:this.ordersCountUrl()},(function(t,a){if(200===a.statusCode&&t){var n=Math.ceil(parseInt(t)/e.pageSize);e.state.page>n?e.toPage(n):e.setState({pageCount:n})}})))}},{key:"toPage",value:function(t){var a=this;this.setState({page:t}),e((function(){return a.getOrders()})),this.history.push({pathname:"/orders",search:"?"+new URLSearchParams({page:t}).toString()})}},{key:"pagination",value:function(){for(var e=this,t=Math.max(this.state.page-2,1),a=Math.min(t+5,this.state.pageCount),n=[],r=function(t){n.push(c.a.createElement(h.a.Item,{onClick:function(){return e.toPage(t)},key:t,active:t===e.state.page},t))},o=t;o<=a;o++)r(o);return c.a.createElement(h.a,null,n)}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement(m.a,null,c.a.createElement(d.a,{md:"2"},c.a.createElement("h3",null,"Orders"))),c.a.createElement(E.a,{orders:this.state.orders}),c.a.createElement(m.a,null,c.a.createElement(d.a,null,this.pagination())))}}]),a}(c.a.Component);t.a=v}).call(this,a(67).setImmediate)}},[[121,1,2]]]);
//# sourceMappingURL=main.34938b3a.chunk.js.map